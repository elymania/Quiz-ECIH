<!DOCTYPE html>
<html lang="en" oncontextmenu="return false;">
<head>
  <meta charset="UTF-8" />
  <title>ECIH Practice Exam</title>
  <!-- Chart.js for pie charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* Disable text selection (basic protection) */
    html, body {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      color: #333;
    }
    body {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    header {
      background: #003366;
      color: #fff;
      padding: 10px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }
    header h1 {
      margin: 0;
      font-size: 1.5em;
    }
    header .nav-buttons {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 5px;
    }
    .about-btn {
      background: transparent;
      border: 2px solid #fff;
      color: #fff;
      padding: 5px 10px;
      cursor: pointer;
      border-radius: 4px;
      font-weight: bold;
    }
    main {
      flex: 1;
      max-width: 900px;
      width: 100%;
      margin: 10px auto;
      padding: 10px;
      background: #fff;
      border-radius: 6px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      position: relative;
    }
    #top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 10px;
    }
    .arrow-btn {
      background: #2196F3;
      color: #fff;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
    .arrow-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    #question-counter {
      font-weight: bold;
    }
    #timer-container {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 5px;
    }
    #timer {
      font-weight: bold;
      padding: 5px 10px;
      background: #efefef;
      border-radius: 4px;
    }
    #timer-bar-container {
      width: 300px;
      background: #ddd;
      border-radius: 4px;
      overflow: hidden;
      height: 10px;
      position: relative;
    }
    #timer-bar {
      height: 10px;
      background: #4caf50;
      width: 100%;
    }
    .question-container {
      margin-bottom: 20px;
    }
    .options-container {
      margin: 15px 0;
    }
    .explanation {
      margin: 10px 0;
      padding: 10px;
      background: #f0f0f0;
      border-left: 4px solid #ccc;
      display: none;
    }
    .correct {
      background-color: #c8f7c5; /* light green */
    }
    .incorrect {
      background-color: #f7c5c5; /* light red */
    }
    .btn {
      display: inline-block;
      padding: 10px 20px;
      margin: 5px 5px 5px 0;
      cursor: pointer;
      border: none;
      border-radius: 4px;
      color: #fff;
      font-weight: bold;
    }
    .btn-ok {
      background-color: #4CAF50; /* green */
    }
    .btn-final {
      background-color: #FF9800; /* orange */
    }
    #quiz-container,
    #final-score-container,
    #about-container {
      display: none; /* We'll toggle these states */
    }
    #quiz-container.active,
    #final-score-container.active,
    #about-container.active {
      display: block;
    }
    .final-score-container {
      text-align: center;
    }
    .topic-result {
      margin-bottom: 40px;
    }
    /* About container styling */
    #about-container img {
      max-width: 200px;
      border-radius: 8px;
      margin-bottom: 10px;
    }
  </style>
</head>
<body onkeydown="blockShortcuts(event)">

<header>
  <h1>ECIH Certification Practice Exam</h1>
  <div class="nav-buttons">
    <!-- Example about button, optional -->
    <button class="about-btn" onclick="showAbout()">About</button>
  </div>
</header>

<main>
  <!-- TOP BAR: arrows, question count, timer -->
  <div id="top-bar">
    <div style="display: flex; gap: 10px;">
      <button class="arrow-btn" id="prev-btn" onclick="goToPrevQuestion()">&#x2B05;</button>
      <button class="arrow-btn" id="next-btn" onclick="goToNextQuestion()">&#x27A1;</button>
      <div id="question-counter"></div>
    </div>
    <div id="timer-container">
      <div id="timer">00:00:00</div>
      <div id="timer-bar-container">
        <div id="timer-bar"></div>
      </div>
    </div>
  </div>

  <!-- QUIZ CONTAINER -->
  <div id="quiz-container" class="active">
    <div class="question-container">
      <h3 id="question-text"></h3>
    </div>
    <div class="options-container" id="options-container">
      <!-- radio/checkbox options get inserted here -->
    </div>
    <button class="btn btn-ok" id="check-answer-btn">OK</button>
    <div class="explanation" id="explanation-box"></div>
    <div style="text-align: center; margin-top: 20px;">
      <button class="btn btn-final" id="final-score-btn" disabled>FINAL SCORE</button>
    </div>
  </div>

  <!-- FINAL SCORE CONTAINER -->
  <div id="final-score-container" class="final-score-container">
    <h2>Final Exam Report</h2>
    <p id="score-summary"></p>
    <p id="score-passfail" style="font-weight: bold;"></p>
    <div id="topic-stats"></div>
  </div>

  <!-- ABOUT CONTAINER -->
  <div id="about-container">
    <h2>About Andrea Piras</h2>
    <img src="data:image/jpeg;base64,...YOUR_IMAGE_DATA..." alt="Andrea Piras Photo" />
    <p>
      I am CERT Manager at a company that provides incident response and Cyber Threat Intelligence services.
      I have a master's degree in computer engineering, cybersecurity and artificial intelligence
      from the University of Cagliari. In addition to managing cyber incident response, I am
      responsible for coordinating the Intelligence team to anticipate threats that may affect
      organizations, and I help customers develop a cybersecurity strategy in line with the National
      Security Framework. I am familiar with NIS compliance, GDPR, AGID, the National Security Perimeter,
      and cyber risk management. The CERT (Computer Emergency Response Team) in which I work is
      responsible for responding promptly to incidents, not only with EDR support, but also with Digital
      Forensics acquisition methods, malware analysis, and threat hunting techniques. My team, composed
      of threat hunters and CTI analysts, constantly analyzes the threat landscape and vulnerabilities,
      providing useful executive reports to CISOs and decision makers on controls to add and budgets to
      allocate to security.
    </p>
    <button class="arrow-btn" style="background:#2196F3;" onclick="showQuiz()">Back to Quiz</button>
  </div>
</main>

<script>
// --------------------- Basic Shortcuts Blocking ---------------------
function blockShortcuts(e) {
  // Block certain keys like F12, Ctrl+Shift+I, Ctrl+U, Ctrl+C, etc.
  if (
    e.key === 'F12' ||
    (e.ctrlKey && e.shiftKey && e.key === 'I') ||
    (e.ctrlKey && e.key === 'U') ||
    (e.ctrlKey && e.key === 'C') ||
    (e.metaKey && e.key === 'C') || // for Mac
    e.key === 'PrintScreen'
  ) {
    e.preventDefault();
  }
}
document.addEventListener('contextmenu', event => event.preventDefault());

// --------------------- Example QUESTIONS (replace with your 100) ---------------------
const questions = [
  // ------------------ TOPIC 1: INTRODUCTION (16 total) ------------------
  // (Half scenario, half normal)
  {
    topic: "Topic 1: Introduction",
    question: "Scenario: You are leading an Incident Response team that detects a possible intrusion. What is the primary goal during the early phase of incident handling?",
    options: [
      "Damage containment",
      "Collect marketing data",
      "Implement new hardware",
      "Prepare a press conference"
    ],
    correctAnswers: [0],
    explanation: "Containment aims to reduce the immediate impact of the incident.",
    multipleCorrect: false
  },
  {
    topic: "Topic 1: Introduction",
    question: "Which document outlines the processes and procedures for managing security incidents?",
    options: [
      "Business Continuity Plan",
      "Incident Response Plan",
      "Disaster Recovery Plan",
      "Security Policy"
    ],
    correctAnswers: [1],
    explanation: "An IR plan describes how to handle cyber incidents step by step.",
    multipleCorrect: false
  },
  {
    topic: "Topic 1: Introduction",
    question: "Scenario: Your manager requests guidelines to handle intrusions. Which standard is often cited for information security incident management?",
    options: [
      "ISO 27035",
      "PCI-DSS",
      "HIPAA",
      "GLBA"
    ],
    correctAnswers: [0],
    explanation: "ISO 27035 addresses the management of information security incidents.",
    multipleCorrect: false
  },
  {
    topic: "Topic 1: Introduction",
    question: "What is the main difference between a security event and a security incident?",
    options: [
      "Events happen on weekends only",
      "Incidents have a negative impact or threat",
      "Events cost more money to address",
      "Incidents always involve law enforcement"
    ],
    correctAnswers: [1],
    explanation: "An incident is an event with significant negative impact or potential harm.",
    multipleCorrect: false
  },
  {
    topic: "Topic 1: Introduction",
    question: "Scenario: You have just finished a major cyber crisis simulation. Which phase usually involves documenting lessons learned to improve future responses?",
    options: [
      "Identification",
      "Containment",
      "Lessons Learned",
      "Eradication"
    ],
    correctAnswers: [2],
    explanation: "The Lessons Learned phase captures improvements and insights post-incident.",
    multipleCorrect: false
  },
  {
    topic: "Topic 1: Introduction",
    question: "Which role typically coordinates and oversees incident response at a strategic level?",
    options: [
      "Security Analyst",
      "Incident Manager",
      "Help Desk Technician",
      "System Administrator"
    ],
    correctAnswers: [1],
    explanation: "An Incident Manager leads high-level decisions and coordination.",
    multipleCorrect: false
  },
  {
    topic: "Topic 1: Introduction",
    question: "Scenario: Your company's IR policy requires a strict chain of communication. Why is an updated contact list crucial in an IR Plan?",
    options: [
      "It automatically satisfies all regulations",
      "It helps with marketing new services",
      "It allows quick reach to key stakeholders",
      "It is never important"
    ],
    correctAnswers: [2],
    explanation: "Accurate contacts enable swift communication during an incident.",
    multipleCorrect: false
  },
  {
    topic: "Topic 1: Introduction",
    question: "What is the primary purpose of a post-incident review?",
    options: [
      "Assign blame",
      "Spotlight the IR team's success",
      "Identify areas for improvement",
      "Trigger automatic threat intelligence updates"
    ],
    correctAnswers: [2],
    explanation: "The main goal is to enhance future processes and capabilities.",
    multipleCorrect: false
  },
  {
    topic: "Topic 1: Introduction",
    question: "Scenario: Your organization must comply with regulatory mandates. Which factor usually drives the creation of an IR policy?",
    options: [
      "Pure guesswork",
      "Legal, regulatory, and business requirements",
      "Relying on external contractors only",
      "Outdated risk frameworks"
    ],
    correctAnswers: [1],
    explanation: "Legal, regulatory, and business needs shape an IR policy.",
    multipleCorrect: false
  },
  {
    topic: "Topic 1: Introduction",
    question: "Which of the following are typical phases in an incident response lifecycle? (Select all that apply)",
    options: [
      "Preparation",
      "Detection & Analysis",
      "Containment, Eradication, Recovery",
      "Sales & Marketing"
    ],
    correctAnswers: [0,1,2],
    explanation: "Common phases exclude sales/marketing activities.",
    multipleCorrect: true
  },
  {
    topic: "Topic 1: Introduction",
    question: "Scenario: You are updating an 'Incident Response Policy' document. Which components are generally included? (Select all that apply)",
    options: [
      "Scope and Objectives",
      "Incident definitions",
      "Team roles and responsibilities",
      "Random music playlist"
    ],
    correctAnswers: [0,1,2],
    explanation: "IR policies usually define scope, incident definitions, and team roles.",
    multipleCorrect: true
  },
  {
    topic: "Topic 1: Introduction",
    question: "Why is thorough incident documentation so important?",
    options: [
      "It helps blame certain individuals",
      "It ensures legal evidence and future reference",
      "It automatically solves future incidents",
      "It is rarely required"
    ],
    correctAnswers: [1],
    explanation: "Documentation is vital for legal, root cause analysis, and improvements.",
    multipleCorrect: false
  },
  {
    topic: "Topic 1: Introduction",
    question: "Scenario: After closing an incident, you want to declare it 'fully resolved.' What is a key step to do before that?",
    options: [
      "Publish the incident on social media",
      "Update the entire system hardware",
      "Document all findings thoroughly",
      "Reset all user passwords"
    ],
    correctAnswers: [2],
    explanation: "Complete documentation ensures final closure and knowledge capture.",
    multipleCorrect: false
  },
  {
    topic: "Topic 1: Introduction",
    question: "Which characteristic is most important for an Incident Handler?",
    options: [
      "Advanced marketing knowledge",
      "Attention to detail",
      "Famous social media profile",
      "Artistic talent"
    ],
    correctAnswers: [1],
    explanation: "Attention to detail is critical for analyzing and handling incidents.",
    multipleCorrect: false
  },
  {
    topic: "Topic 1: Introduction",
    question: "Scenario: Your manager wants to know what 'threat intelligence' means in IR. Which statement best describes it?",
    options: [
      "Random data about possible threats",
      "Contextual knowledge about threats to help respond effectively",
      "Just a marketing buzzword",
      "A legal requirement only"
    ],
    correctAnswers: [1],
    explanation: "Threat intelligence gives actionable context about likely threats.",
    multipleCorrect: false
  },
  {
    topic: "Topic 1: Introduction",
    question: "Which of the following are valid reasons to maintain a robust incident response framework? (Select all that apply)",
    options: [
      "Minimize damage and disruption",
      "Fulfill regulatory requirements",
      "Random guessing approach to security",
      "Establish clear communication channels"
    ],
    correctAnswers: [0,1,3],
    explanation: "Damage reduction, compliance, and clear communication are key drivers.",
    multipleCorrect: true
  },

  // ------------------ TOPIC 2: INCIDENT HANDLING PROCESS (16 total) ------------------
  {
    topic: "Topic 2: Incident Handling Process",
    question: "Scenario: Your company uses a 'Preparation' framework to reduce incidents. In which phase do you implement preventive measures?",
    options: [
      "Detection",
      "Preparation",
      "Containment",
      "Eradication"
    ],
    correctAnswers: [1],
    explanation: "Preparation includes proactive steps to prevent or minimize incidents.",
    multipleCorrect: false
  },
  {
    topic: "Topic 2: Incident Handling Process",
    question: "Which is the main objective during the containment phase?",
    options: [
      "Eradicate all vulnerabilities",
      "Only gather threat intelligence",
      "Limit the impact of the incident",
      "Hire more security staff"
    ],
    correctAnswers: [2],
    explanation: "Containment focuses on limiting damage and preventing further spread.",
    multipleCorrect: false
  },
  {
    topic: "Topic 2: Incident Handling Process",
    question: "Scenario: You have removed malicious code and want to restore systems to normal. Which phase covers removing the root cause and returning systems to normal operation?",
    options: [
      "Recovery",
      "Detection",
      "Identification",
      "Preparation"
    ],
    correctAnswers: [0],
    explanation: "Recovery is about restoring normal functionality after eradication.",
    multipleCorrect: false
  },
  {
    topic: "Topic 2: Incident Handling Process",
    question: "During which phase do you confirm if an event actually qualifies as a security incident?",
    options: [
      "Identification",
      "Preparation",
      "Containment",
      "Lessons Learned"
    ],
    correctAnswers: [0],
    explanation: "Identification involves determining whether an event is truly an incident.",
    multipleCorrect: false
  },
  {
    topic: "Topic 2: Incident Handling Process",
    question: "Scenario: You've isolated malware with a tool. Which step is crucial in the 'eradication' phase?",
    options: [
      "Conducting user training",
      "Removing malicious code or access",
      "Posting about the incident on social media",
      "Upgrading all hardware"
    ],
    correctAnswers: [1],
    explanation: "Eradication is about removing the underlying cause, such as malware.",
    multipleCorrect: false
  },
  {
    topic: "Topic 2: Incident Handling Process",
    question: "What is the primary goal of the lessons learned phase?",
    options: [
      "Blame employees who triggered the event",
      "Terminate all security devices",
      "Improve future response",
      "Sell incident data to third parties"
    ],
    correctAnswers: [2],
    explanation: "Lessons learned helps refine processes and strengthen future responses.",
    multipleCorrect: false
  },
  {
    topic: "Topic 2: Incident Handling Process",
    question: "Scenario: You are scanning for Indicators of Compromise (IoCs). In which phase is IoC hunting typically performed to confirm the incident?",
    options: [
      "Identification",
      "Recovery",
      "Containment",
      "Preparation"
    ],
    correctAnswers: [0],
    explanation: "IoCs are sought during Identification to confirm a genuine incident.",
    multipleCorrect: false
  },
  {
    topic: "Topic 2: Incident Handling Process",
    question: "What is the first step in many standard incident response frameworks?",
    options: [
      "Lessons Learned",
      "Containment",
      "Preparation",
      "Eradication"
    ],
    correctAnswers: [2],
    explanation: "Preparation is typically the initial phase in recognized IR frameworks.",
    multipleCorrect: false
  },
  {
    topic: "Topic 2: Incident Handling Process",
    question: "Scenario: Your team uses an automatic isolation script. In which phase is it common to isolate compromised systems to stop further damage?",
    options: [
      "Containment",
      "Recovery",
      "Identification",
      "Post-Incident Review"
    ],
    correctAnswers: [0],
    explanation: "Containment includes isolating compromised hosts to prevent spread.",
    multipleCorrect: false
  },
  {
    topic: "Topic 2: Incident Handling Process",
    question: "Which activity is performed during 'detection and analysis'?",
    options: [
      "Gathering new marketing leads",
      "Monitoring logs and alerts for anomalies",
      "Shutting down all network traffic forever",
      "Punishing employees for near-misses"
    ],
    correctAnswers: [1],
    explanation: "Detection and analysis involves monitoring to identify suspicious activity.",
    multipleCorrect: false
  },
  {
    topic: "Topic 2: Incident Handling Process",
    question: "Scenario: You used a tool to remove a trojan. What is a key outcome of the eradication phase?",
    options: [
      "Incident never happened",
      "All malicious components removed",
      "Employees become experts in marketing",
      "Ceasing all future security updates"
    ],
    correctAnswers: [1],
    explanation: "Eradication means removing malicious elements to stop recurrence.",
    multipleCorrect: false
  },
  {
    topic: "Topic 2: Incident Handling Process",
    question: "Which phase follows containment in most incident handling methods?",
    options: [
      "Eradication",
      "Identification",
      "Sales",
      "Data Archival"
    ],
    correctAnswers: [0],
    explanation: "After containing a threat, the next step is to eradicate it.",
    multipleCorrect: false
  },
  {
    topic: "Topic 2: Incident Handling Process",
    question: "Which of the following is NOT a typical IR phase?",
    options: [
      "Identification",
      "Containment",
      "Contemplation",
      "Recovery"
    ],
    correctAnswers: [2],
    explanation: "Contemplation is not recognized as an official IR phase.",
    multipleCorrect: false
  },
  {
    topic: "Topic 2: Incident Handling Process",
    question: "Which are common containment strategies? (Select all that apply)",
    options: [
      "Segregating network segments",
      "Powering off compromised systems abruptly",
      "Blocking malicious IP addresses",
      "Disabling relevant user accounts"
    ],
    correctAnswers: [0,2,3],
    explanation: "Segmentation, IP blocking, and account disabling help contain threats. Abrupt power-offs can destroy volatile data.",
    multipleCorrect: true
  },
  {
    topic: "Topic 2: Incident Handling Process",
    question: "Scenario: After an incident, you use backups to restore systems. Which actions are part of a solid recovery approach? (Select all that apply)",
    options: [
      "Restoring from clean backups",
      "Applying patches and correct configurations",
      "Deleting user accounts permanently",
      "Verifying normal operations"
    ],
    correctAnswers: [0,1,3],
    explanation: "Recovery includes clean restore, patching, and checking functionality. Not removing all user accounts.",
    multipleCorrect: true
  },
  {
    topic: "Topic 2: Incident Handling Process",
    question: "Which tasks are recommended in the 'preparation' phase? (Select all that apply)",
    options: [
      "Developing IR policies",
      "Training staff regularly",
      "Ignoring threat intelligence",
      "Maintaining necessary tools"
    ],
    correctAnswers: [0,1,3],
    explanation: "Preparation includes well-defined policies, training, and tool readiness.",
    multipleCorrect: true
  },

  // ------------------ TOPIC 3: FORENSIC READINESS & FIRST RESPONSE (17 total) ------------------
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "Scenario: You set up an automated system to collect evidence. What does 'forensic readiness' primarily entail?",
    options: [
      "Collecting evidence in an admissible way",
      "Eliminating all USB ports",
      "Encrypting data arbitrarily",
      "Deactivating all logs"
    ],
    correctAnswers: [0],
    explanation: "Forensic readiness involves being prepared to collect/preserve evidence lawfully.",
    multipleCorrect: false
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "Which is typically a first response activity?",
    options: [
      "Notifying law enforcement right away",
      "Preserving volatile data",
      "Rebooting all machines",
      "Sending press releases"
    ],
    correctAnswers: [1],
    explanation: "Preserving volatile data is crucial at the start.",
    multipleCorrect: false
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "Scenario: Your team manages digital evidence with a chain-of-custody tool. Which principle is vital to maintain evidence integrity?",
    options: [
      "Complex encryption algorithms",
      "Free disk space",
      "Chain of custody",
      "Frequent hardware replacements"
    ],
    correctAnswers: [2],
    explanation: "A documented chain of custody proves evidence was not tampered with.",
    multipleCorrect: false
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "Which of these is considered a volatile data source?",
    options: [
      "RAM contents",
      "Hard disk",
      "Archived logs",
      "DVD media"
    ],
    correctAnswers: [0],
    explanation: "RAM is volatile since it's lost when power is removed.",
    multipleCorrect: false
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "Scenario: You use a memory forensics tool to analyze an endpoint. Which tool is commonly known for memory forensics?",
    options: [
      "Wireshark",
      "Volatility",
      "Burp Suite",
      "Nmap"
    ],
    correctAnswers: [1],
    explanation: "Volatility is widely used for in-depth memory analysis.",
    multipleCorrect: false
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "What is critical when creating forensic images of disks?",
    options: [
      "Using the fastest imaging method",
      "Utilizing a write-blocker",
      "Overwriting the original disk",
      "Avoiding hashing"
    ],
    correctAnswers: [1],
    explanation: "A write-blocker ensures the original data is preserved.",
    multipleCorrect: false
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "Scenario: You've studied 'order of volatility.' Which order is correct from most volatile to least?",
    options: [
      "CPU cache, RAM, Network state, Hard disk",
      "Hard disk, RAM, CPU cache, Network state",
      "RAM, CPU cache, Hard disk, Network state",
      "Network state, Hard disk, RAM, CPU cache"
    ],
    correctAnswers: [0],
    explanation: "CPU cache is most volatile, then RAM, then network state, then disk.",
    multipleCorrect: false
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "Why do we collect digital evidence systematically?",
    options: [
      "To meet data privacy laws automatically",
      "To ensure it's reliable and legally admissible",
      "To shorten the process",
      "To disregard chain-of-custody"
    ],
    correctAnswers: [1],
    explanation: "A proper systematic approach guarantees reliability in court or investigation.",
    multipleCorrect: false
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "Scenario: You have a portable 'jump kit' named IR-GoPack. What is the best description of such a kit?",
    options: [
      "A stack of policies only",
      "A quick-to-deploy toolkit for IR",
      "A marketing flyer",
      "A special USB encryption protocol"
    ],
    correctAnswers: [1],
    explanation: "A jump kit contains the essential tools for immediate incident response.",
    multipleCorrect: false
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "In forensics, why do we hash evidence files?",
    options: [
      "To compress them drastically",
      "To make them unreadable",
      "To verify integrity and detect tampering",
      "To discard them later"
    ],
    correctAnswers: [2],
    explanation: "Hashing ensures we can confirm no changes occurred to the evidence.",
    multipleCorrect: false
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "Scenario: You track every person who handles a hard drive of evidence. Which practice does this represent?",
    options: [
      "Restricting staff from seeing data",
      "Chain of custody documentation",
      "Performing a marketing campaign",
      "Deleting logs frequently"
    ],
    correctAnswers: [1],
    explanation: "Recording each handler is essential to maintain chain of custody.",
    multipleCorrect: false
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "When is it best to collect memory during an incident?",
    options: [
      "After shutting down the system",
      "Immediately, before powering off",
      "Never, it's irrelevant",
      "Only after the system reboots"
    ],
    correctAnswers: [1],
    explanation: "Memory must be captured early to avoid losing volatile data.",
    multipleCorrect: false
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "Scenario: You cloned a disk using SafeClone. What is the next recommended step?",
    options: [
      "Erase the original disk",
      "Verify the image with a hash",
      "Distribute it to everyone",
      "No further steps are needed"
    ],
    correctAnswers: [1],
    explanation: "Verifying the cloned image ensures its integrity matches the original.",
    multipleCorrect: false
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "Which aspect is critical in a forensic readiness plan?",
    options: [
      "Minimizing logs to save disk space",
      "Identifying evidence sources and retaining logs",
      "Only focusing on memory acquisitions",
      "Excluding staff from knowledge of IR"
    ],
    correctAnswers: [1],
    explanation: "Knowing where evidence might reside and keeping proper logs is essential.",
    multipleCorrect: false
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "Which practices help preserve digital evidence integrity? (Select all that apply)",
    options: [
      "Hashing collected data",
      "Documenting chain of custody",
      "Performing live analysis directly on original media",
      "Storing evidence securely"
    ],
    correctAnswers: [0,1,3],
    explanation: "Hashing, chain of custody, and secure storage preserve integrity. Live analysis on original media can alter data.",
    multipleCorrect: true
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "Scenario: An analyst suggests capturing volatile data and isolating a system if needed. Which are best practices for first responders? (Select all that apply)",
    options: [
      "Preserve volatile data first",
      "Isolate the system when appropriate",
      "Ignore the company IR policy",
      "Contact relevant stakeholders promptly"
    ],
    correctAnswers: [0,1,3],
    explanation: "Preserve volatile data, isolate as needed, and follow policy by informing the right people.",
    multipleCorrect: true
  },
  {
    topic: "Topic 3: Forensic Readiness and First Response",
    question: "Which sources commonly provide digital evidence in investigations? (Select all that apply)",
    options: [
      "Network traffic logs",
      "System RAM",
      "Video surveillance footage",
      "Smart coffee machine usage"
    ],
    correctAnswers: [0,1,2],
    explanation: "Network logs, RAM content, and CCTV can be valid evidence. Coffee usage is typically not relevant.",
    multipleCorrect: true
  },

  // ------------------ TOPIC 4: INCIDENT ANALYSIS (17 total) ------------------
  {
    topic: "Topic 4: Incident Analysis",
    question: "Which tool is commonly used to analyze network traffic during an incident?",
    options: [
      "Wireshark",
      "Microsoft Word",
      "Adobe Photoshop",
      "Music player"
    ],
    correctAnswers: [0],
    explanation: "Wireshark captures and inspects network packets in detail.",
    multipleCorrect: false
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Scenario: You are using a log aggregator from multiple servers. What is 'log correlation'?",
    options: [
      "Deleting logs systematically",
      "Matching logs from different sources to find patterns",
      "Separating logs from the same source",
      "Never examining log timestamps"
    ],
    correctAnswers: [1],
    explanation: "Correlating logs across multiple sources helps identify linked events.",
    multipleCorrect: false
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Which might indicate that an incident is occurring?",
    options: [
      "All systems showing normal CPU usage",
      "Unauthorized account creation",
      "Scheduled maintenance",
      "Legitimate software installation"
    ],
    correctAnswers: [1],
    explanation: "Unexpected unauthorized accounts strongly suggest a possible intrusion.",
    multipleCorrect: false
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Scenario: You receive an alert for a suspicious IP address. Which is an example of an Indicator of Compromise (IoC)?",
    options: [
      "Official OS update",
      "Known malicious IP",
      "Marketing email",
      "Routine DNS query"
    ],
    correctAnswers: [1],
    explanation: "A known malicious IP is a classic IoC signifying a possible threat.",
    multipleCorrect: false
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Which type of analysis compares normal activity with current data to detect anomalies?",
    options: [
      "Comparative analysis",
      "Baseline analysis",
      "Legal analysis",
      "Minimalistic analysis"
    ],
    correctAnswers: [1],
    explanation: "Baseline analysis compares known-good patterns to highlight deviations.",
    multipleCorrect: false
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Scenario: You gather logs with synchronized timestamps. What is crucial for reconstructing an incident timeline?",
    options: [
      "Consistent time synchronization",
      "Ignoring old logs",
      "Relying on user memory only",
      "Skipping major events"
    ],
    correctAnswers: [0],
    explanation: "Aligned timestamps across systems are essential for a cohesive timeline.",
    multipleCorrect: false
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Which best describes root cause analysis?",
    options: [
      "Finding a random cause of the incident",
      "Identifying the fundamental reason behind an incident",
      "Placing blame on the last person who logged in",
      "Quickly scanning logs with no methodology"
    ],
    correctAnswers: [1],
    explanation: "Root cause analysis uncovers the true underlying factor for an incident.",
    multipleCorrect: false
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Scenario: Your environment runs NTP on all servers. Why is time synchronization essential for incident analysis?",
    options: [
      "It creates unique log formats",
      "It ensures correlated logs across systems",
      "It overwrites old logs easily",
      "It reduces network overhead"
    ],
    correctAnswers: [1],
    explanation: "Accurate, consistent timestamps enable cross-system correlation of events.",
    multipleCorrect: false
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Which tool can detect anomalies in system behavior via machine learning?",
    options: [
      "Snort IDS",
      "Splunk UBA",
      "Paint application",
      "Plain Telnet client"
    ],
    correctAnswers: [1],
    explanation: "User Behavior Analytics (UBA) employs ML to find suspicious patterns.",
    multipleCorrect: false
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Scenario: Your alerting system triggered an alarm that turned out benign. What do we call this phenomenon?",
    options: [
      "True positive",
      "False positive",
      "False negative",
      "Missed detection"
    ],
    correctAnswers: [1],
    explanation: "A false positive is when an alert is triggered but there's no actual threat.",
    multipleCorrect: false
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Which scenario might be a 'false negative'?",
    options: [
      "An alert triggered for a harmless event",
      "Multiple alerts for the same threat",
      "A real intrusion undetected by security controls",
      "Authorized user login from the same location"
    ],
    correctAnswers: [2],
    explanation: "A false negative is when a real threat is missed entirely.",
    multipleCorrect: false
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Scenario: You are using an IoC pivot technique. What is 'pivoting' in incident analysis?",
    options: [
      "Switching IR team roles randomly",
      "Using one clue to find related evidence",
      "Stopping the investigation after partial data",
      "Delegating everything to another department"
    ],
    correctAnswers: [1],
    explanation: "Pivoting means leveraging one indicator to uncover associated data or hosts.",
    multipleCorrect: false
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Which factor is most important for detecting advanced persistent threats (APTs)?",
    options: [
      "Occasional user security training",
      "Long-term log and behavior analysis",
      "Blocking all websites globally",
      "Trusting a single antivirus software"
    ],
    correctAnswers: [1],
    explanation: "APTs often require lengthy or behavioral analysis to detect stealthy tactics.",
    multipleCorrect: false
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Scenario: Your SIEM logs too many irrelevant events. Which principle helps reduce noise?",
    options: [
      "Never filter any data",
      "Implement selective logging and filters",
      "Collect logs from every source worldwide",
      "Ignore critical alerts"
    ],
    correctAnswers: [1],
    explanation: "Proper filtering focuses on relevant events, cutting down false positives.",
    multipleCorrect: false
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Which data sources are commonly used in incident analysis? (Select all that apply)",
    options: [
      "System logs",
      "Network packet captures",
      "Threat intelligence feeds",
      "Casual social media posts"
    ],
    correctAnswers: [0,1,2],
    explanation: "System logs, network captures, and threat intel are primary sources. Random social media is less typical.",
    multipleCorrect: true
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Scenario: You implemented log normalization. Which steps are considered best practices for log analysis? (Select all that apply)",
    options: [
      "Normalizing log formats",
      "Correlating events across systems",
      "Ignoring unusual spikes",
      "Setting relevant alert thresholds"
    ],
    correctAnswers: [0,1,3],
    explanation: "Normalization, correlation, and sensible thresholds are crucial. Not ignoring spikes.",
    multipleCorrect: true
  },
  {
    topic: "Topic 4: Incident Analysis",
    question: "Which challenges are common in incident analysis? (Select all that apply)",
    options: [
      "Encrypted traffic",
      "High volume of alerts",
      "Abundance of skilled analysts",
      "Alert fatigue"
    ],
    correctAnswers: [0,1,3],
    explanation: "Encryption, alert overload, and fatigue are typical. A shortage, not abundance, of skilled analysts is common.",
    multipleCorrect: true
  },

  // ------------------ TOPIC 5: HANDLING DIFFERENT TYPES OF INCIDENTS (17 total) ------------------
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Scenario: Your system 'FraudCheck' monitors financial data manipulations. Which incident type involves unauthorized data alteration for financial gain?",
    options: [
      "DoS attack",
      "Social engineering",
      "Fraud incident",
      "Ransomware"
    ],
    correctAnswers: [2],
    explanation: "Fraud incidents revolve around manipulating data or transactions for profit.",
    multipleCorrect: false
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "What is the main characteristic of a ransomware attack?",
    options: [
      "Instant web defacement",
      "Files are encrypted and a ransom is demanded",
      "Stealthy infiltration over months",
      "Physical server theft"
    ],
    correctAnswers: [1],
    explanation: "Ransomware typically encrypts data and requests payment for decryption.",
    multipleCorrect: false
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Scenario: Your IDS 'FloodStop' sees huge traffic volumes. Which attack aims to overload resources and make systems unavailable?",
    options: [
      "Unauthorized access",
      "Denial of Service (DoS)",
      "Insider threat",
      "Phishing"
    ],
    correctAnswers: [1],
    explanation: "DoS or DDoS saturates the target with traffic to disrupt service.",
    multipleCorrect: false
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Which insider threat scenario poses significant danger?",
    options: [
      "Accidental misconfiguration",
      "Disgruntled employee with privileged access",
      "User forgetting password occasionally",
      "Visitor tailgating once"
    ],
    correctAnswers: [1],
    explanation: "A privileged, disgruntled insider has the means to do major harm.",
    multipleCorrect: false
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Scenario: An attacker replaced your company's homepage with defacement messages. What is a typical sign of web defacement?",
    options: [
      "Website content replaced by hacker messages",
      "No visible UI changes at all",
      "Emails bouncing back",
      "Antivirus updates failing"
    ],
    correctAnswers: [0],
    explanation: "Defacement replaces legitimate web content with unauthorized text or images.",
    multipleCorrect: false
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Which incident type commonly tricks users into revealing sensitive information?",
    options: [
      "Brute force",
      "Phishing",
      "Malware infection",
      "Eavesdropping"
    ],
    correctAnswers: [1],
    explanation: "Phishing deceives users into divulging credentials or data.",
    multipleCorrect: false
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Scenario: Your 'APTWatch' system detects stealthy, long-term infiltration attempts. What is the main motive of an Advanced Persistent Threat?",
    options: [
      "Immediate website defacement",
      "Simple opportunistic spam",
      "Long-term espionage or sabotage",
      "Random CPU usage spikes"
    ],
    correctAnswers: [2],
    explanation: "APTs aim for prolonged, covert access to gather intelligence or disrupt.",
    multipleCorrect: false
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Which best describes a 'watering hole' attack?",
    options: [
      "Targeting a physical water facility",
      "Compromising a popular site visited by targets",
      "Sending mass spam emails blindly",
      "Intercepting traffic passively"
    ],
    correctAnswers: [1],
    explanation: "A watering hole hack infects a trusted site that targets frequent.",
    multipleCorrect: false
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Scenario: Your 'ZeroDayScanner' found an unknown vulnerability. What challenge is typical with zero-day exploits?",
    options: [
      "Readily available patches",
      "Easy detection by antivirus",
      "No official patch at first discovery",
      "They are disclosed months in advance"
    ],
    correctAnswers: [2],
    explanation: "Zero-days have no existing patches, making them hard to mitigate immediately.",
    multipleCorrect: false
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Which approach is most effective against phishing attacks?",
    options: [
      "Infrequent security training",
      "Frequent OS patching only",
      "Continuous user education and email filtering",
      "Blacklisting all IP addresses"
    ],
    correctAnswers: [2],
    explanation: "Phishing defenses rely heavily on training and filtering suspicious emails.",
    multipleCorrect: false
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Scenario: 'NetSpyder' sees traffic interception between two hosts. How do man-in-the-middle (MITM) attacks commonly occur?",
    options: [
      "Stealing physical servers",
      "Intercepting communication between parties",
      "Brute forcing user accounts",
      "Hacking coffee machines"
    ],
    correctAnswers: [1],
    explanation: "MITM intercepts data flow between two endpoints to eavesdrop or inject content.",
    multipleCorrect: false
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Which sign suggests a potential insider attack?",
    options: [
      "Mass data exfiltration by an authorized user",
      "Public website defacement from external IP",
      "Basic port scanning from the internet",
      "Reports from threat intel on external criminals"
    ],
    correctAnswers: [0],
    explanation: "A user with legitimate access exfiltrating large data is a key insider threat indicator.",
    multipleCorrect: false
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Scenario: 'RansomAlert' shows mass file encryption. What is a recommended first step when responding to ransomware?",
    options: [
      "Immediately pay the ransom",
      "Disconnect infected systems",
      "Erase all backups",
      "Announce the incident publicly"
    ],
    correctAnswers: [1],
    explanation: "Isolating infected hosts helps contain ransomware spread.",
    multipleCorrect: false
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Which are common signs of a phishing email? (Select all that apply)",
    options: [
      "Suspicious links",
      "Urgent requests for personal data",
      "Perfect grammar always",
      "Sender address mismatch"
    ],
    correctAnswers: [0,1,3],
    explanation: "Phishing often has suspicious links, urgent requests, or mismatched senders. Grammar can vary.",
    multipleCorrect: true
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Scenario: 'Anti-DDoSGuard' is mitigating an attack. Which steps help reduce a DoS/DDoS impact? (Select all that apply)",
    options: [
      "Using content delivery networks",
      "Implementing rate-limiting",
      "Opening all network ports",
      "Deploying firewalls or WAFs"
    ],
    correctAnswers: [0,1,3],
    explanation: "CDNs, rate-limits, and web/firewall filters are common DDoS countermeasures.",
    multipleCorrect: true
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Which actions help when handling malware incidents? (Select all that apply)",
    options: [
      "Identifying malware type",
      "Isolating infected hosts",
      "Ignoring event logs",
      "Running antivirus scans"
    ],
    correctAnswers: [0,1,3],
    explanation: "Identification, isolation, and scanning are essential. Logs should not be ignored.",
    multipleCorrect: true
  },
  {
    topic: "Topic 5: Different Types of Incidents",
    question: "Scenario: 'InsiderWatch' logs suspicious after-hours behavior. Which are key insider threat indicators? (Select all that apply)",
    options: [
      "Unusual off-hours activity",
      "Excessive data downloads",
      "Constantly reporting near-misses",
      "Privilege escalation without justification"
    ],
    correctAnswers: [0,1,3],
    explanation: "Late-hour logins, large data exports, and unjustified privilege changes raise red flags.",
    multipleCorrect: true
  },

  // ------------------ TOPIC 6: ERADICATION, RECOVERY, POST-INCIDENT (17 total) ------------------
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "What is the primary goal of the eradication phase?",
    options: [
      "Documenting the entire timeline",
      "Removing the root cause completely",
      "Issuing public statements",
      "Detecting future vulnerabilities"
    ],
    correctAnswers: [1],
    explanation: "Eradication eliminates the cause to ensure the threat is fully removed.",
    multipleCorrect: false
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "Scenario: Before restoring a compromised server, what is crucial to do with backups?",
    options: [
      "Verify backups are clean",
      "Delete all backup logs",
      "Announce the breach on social media",
      "No checks are required"
    ],
    correctAnswers: [0],
    explanation: "You must ensure backups are not infected before restoring them.",
    multipleCorrect: false
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "When is an organization ready to move from eradication to recovery?",
    options: [
      "As soon as partial function returns",
      "Once the threat is removed and vulnerabilities addressed",
      "Immediately after detection",
      "Only after legal approvals"
    ],
    correctAnswers: [1],
    explanation: "Recovery follows successful eradication of threats and fixes to vulnerabilities.",
    multipleCorrect: false
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "Scenario: You plan a lessons learned meeting after an incident. Which best describes this session?",
    options: [
      "A blame session",
      "A focus on awarding top employees",
      "A collaborative review to improve future IR",
      "A forced HR procedure"
    ],
    correctAnswers: [2],
    explanation: "Lessons learned is a collective effort to refine future response strategies.",
    multipleCorrect: false
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "Why is it important to collect metrics during an incident response?",
    options: [
      "To blame staff for overtime",
      "To improve marketing presentations",
      "To measure response effectiveness",
      "It is not relevant"
    ],
    correctAnswers: [2],
    explanation: "Metrics help evaluate and refine IR performance and capabilities.",
    multipleCorrect: false
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "Scenario: You are using a 'RecoveryAssist' procedure. What is a key consideration during recovery?",
    options: [
      "Restoring normal operations securely",
      "Delaying system restoration",
      "Deleting all historical logs",
      "Publishing breach details widely"
    ],
    correctAnswers: [0],
    explanation: "Recovery must ensure the environment is stable and secure.",
    multipleCorrect: false
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "When should a post-incident review ideally be conducted?",
    options: [
      "Weeks after everyone forgets details",
      "Immediately after detection",
      "Shortly after closure so details remain fresh",
      "Only if mandatory by law"
    ],
    correctAnswers: [2],
    explanation: "A timely review captures accurate insights while memories are fresh.",
    multipleCorrect: false
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "Scenario: You performed root cause analysis on how an incident occurred. What is a direct benefit of root cause analysis?",
    options: [
      "Improving marketing reach",
      "Ensuring the same cause won't reoccur",
      "Forced staff reductions",
      "No benefit at all"
    ],
    correctAnswers: [1],
    explanation: "Addressing the root cause helps prevent repeated incidents.",
    multipleCorrect: false
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "Which documentation is crucial in post-incident activities?",
    options: [
      "Updated contact lists only",
      "A detailed incident report with timeline and lessons learned",
      "No documentation is needed",
      "Just the total cost of the incident"
    ],
    correctAnswers: [1],
    explanation: "A comprehensive report helps with compliance, future reference, and improvements.",
    multipleCorrect: false
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "Scenario: You run a final scan to ensure no hidden backdoors remain. Why is re-testing the environment important?",
    options: [
      "To waste time and resources",
      "It is unnecessary if backups were used",
      "To confirm the system is clean and secure",
      "Only if a competitor demands it"
    ],
    correctAnswers: [2],
    explanation: "Verifying there are no lingering threats ensures a thorough recovery.",
    multipleCorrect: false
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "Which is a sensible post-incident follow-up measure?",
    options: [
      "Banning future incident reports",
      "Performing a new risk assessment",
      "Halting security training",
      "Downgrading security devices"
    ],
    correctAnswers: [1],
    explanation: "A risk assessment post-incident refines security posture.",
    multipleCorrect: false
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "What is the ultimate goal of post-incident documentation?",
    options: [
      "Create a marketing case",
      "Provide facts for organizational learning",
      "Automatically file lawsuits",
      "Delete evidence to avoid liabilities"
    ],
    correctAnswers: [1],
    explanation: "Documentation fosters knowledge, compliance, and future improvements.",
    multipleCorrect: false
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "Scenario: You finalized an incident closure report. Which element is often included in a final incident report?",
    options: [
      "A personal apology from the CEO",
      "Technical details and remediation steps",
      "Publicly listing employees at fault",
      "Predicting stock prices"
    ],
    correctAnswers: [1],
    explanation: "A closure report usually covers technical aspects, solutions applied, and lessons learned.",
    multipleCorrect: false
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "Which actions help ensure successful eradication? (Select all that apply)",
    options: [
      "Applying patches for known vulnerabilities",
      "Removing malicious artifacts",
      "Ignoring logs to save time",
      "Validating no hidden backdoors remain"
    ],
    correctAnswers: [0,1,3],
    explanation: "Eradication includes patching, removing malware, and confirming no further compromises.",
    multipleCorrect: true
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "What should be verified before declaring recovery complete? (Select all that apply)",
    options: [
      "All systems function normally",
      "No residual malware is present",
      "Incident is fully contained",
      "Replacing all employees"
    ],
    correctAnswers: [0,1,2],
    explanation: "Systems must be normal, no threats remain, and the incident is contained. Replacing staff is not standard.",
    multipleCorrect: true
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "Scenario: You collected IR metrics to evaluate performance. Which metrics might be tracked in a post-incident review? (Select all that apply)",
    options: [
      "Time to detect (TTD)",
      "Time to respond (TTR)",
      "Accuracy of detection vs. false positives",
      "Number of coffee breaks"
    ],
    correctAnswers: [0,1,2],
    explanation: "Typical metrics include detection time, response time, and detection accuracy. Coffee breaks are irrelevant.",
    multipleCorrect: true
  },
  {
    topic: "Topic 6: Eradication & Recovery",
    question: "Which improvements often result from post-incident analysis? (Select all that apply)",
    options: [
      "Better IR procedures",
      "Enhanced user training",
      "Stronger security controls",
      "Eliminating all security measures"
    ],
    correctAnswers: [0,1,2],
    explanation: "Post-incident analysis leads to refined procedures, training, and defenses, not removing them.",
    multipleCorrect: true
  }
];

// -------------- Shuffle the questions --------------
function shuffleArray(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
}
shuffleArray(questions);

// *** NEW CODE: Select only 30 random questions from the 100 ***
const totalQuizQuestions = 30;
questions.splice(totalQuizQuestions);  // Remove any questions beyond the 30th
// Alternatively, you can use: questions = questions.slice(0, totalQuizQuestions);


// ------------- Global Variables -------------
let currentQuestionIndex = 0;
let userAnswers = new Array(questions.length).fill(null); 
// store arrays of selected indexes for each question
let correctCountByTopic = {};
let questionCountByTopic = {};
let answeredCount = 0; // how many questions have been answered with "OK"
let timerDuration = 30 * 60; // 30 minutes in seconds
let timerInterval = null;

// Populate the topic counts
questions.forEach((q) => {
  if (!questionCountByTopic[q.topic]) {
    questionCountByTopic[q.topic] = 0;
    correctCountByTopic[q.topic] = 0;
  }
  questionCountByTopic[q.topic]++;
});

window.addEventListener('DOMContentLoaded', initQuiz);

function initQuiz() {
  document.getElementById('final-score-btn').addEventListener('click', showFinalScore);
  document.getElementById('check-answer-btn').addEventListener('click', checkAnswer);

  showQuestion(currentQuestionIndex);
  startTimer();
  updateAnsweredCounter();
  updateArrows();
}

function startTimer() {
  updateTimerDisplay(timerDuration);
  timerInterval = setInterval(() => {
    timerDuration--;
    if (timerDuration <= 0) {
      clearInterval(timerInterval);
      // Time is up -> show final score
      showFinalScore();
    } else {
      updateTimerDisplay(timerDuration);
    }
  }, 1000);
}

function updateTimerDisplay(secLeft) {
  let hours = Math.floor(secLeft / 3600);
  let minutes = Math.floor((secLeft % 3600) / 60);
  let secs = secLeft % 60;

  const hh = hours.toString().padStart(2, '0');
  const mm = minutes.toString().padStart(2, '0');
  const ss = secs.toString().padStart(2, '0');

  document.getElementById('timer').innerText = `${hh}:${mm}:${ss}`;

  // Progress bar
  let totalSec = 30 * 60; 
  let fraction = secLeft / totalSec;
  let barWidth = fraction * 100;
  document.getElementById('timer-bar').style.width = barWidth + "%";
}

// ------------ Display a question ------------
function showQuestion(index) {
  const questionData = questions[index];
  const questionText = document.getElementById('question-text');
  const optionsContainer = document.getElementById('options-container');
  const explanationBox = document.getElementById('explanation-box');

  questionText.innerText = `Question ${index + 1}: ${questionData.question}`;
  optionsContainer.innerHTML = '';
  explanationBox.style.display = 'none';
  explanationBox.innerHTML = '';

  const inputType = questionData.multipleCorrect ? 'checkbox' : 'radio';
  questionData.options.forEach((opt, i) => {
    const wrapper = document.createElement('div');
    const input = document.createElement('input');
    const label = document.createElement('label');

    input.type = inputType;
    input.name = 'question-options-' + index; 
    input.value = i;
    input.id = `option-${index}-${i}`;
    label.setAttribute('for', `option-${index}-${i}`);
    label.innerText = opt;

    wrapper.appendChild(input);
    wrapper.appendChild(label);
    optionsContainer.appendChild(wrapper);
  });

  // If userAnswers[index] is not null, re-check those options
  if (userAnswers[index] !== null) {
    let previouslySelected = userAnswers[index];
    previouslySelected.forEach(sel => {
      const existingElem = document.getElementById(`option-${index}-${sel}`);
      if (existingElem) {
        existingElem.checked = true;
      }
    });
  }

  // Show/hide final score button if last question
  const finalBtn = document.getElementById('final-score-btn');
  if (index === questions.length - 1) {
    finalBtn.style.display = 'inline-block';
    // Enable or disable final score depending on whether user has answered this question
    if (userAnswers[index] !== null) {
      finalBtn.disabled = false;
    } else {
      finalBtn.disabled = true;
    }
  } else {
    finalBtn.style.display = 'none';
  }
}

function checkAnswer() {
  const questionData = questions[currentQuestionIndex];
  const explanationBox = document.getElementById('explanation-box');
  explanationBox.style.display = 'block';

  const inputs = document.getElementsByName(`question-options-${currentQuestionIndex}`);
  let selectedValues = [];
  for (let inp of inputs) {
    if (inp.checked) {
      selectedValues.push(parseInt(inp.value, 10));
    }
  }

  if (selectedValues.length === 0) {
    explanationBox.innerHTML = "<strong style='color:red;'>No option selected!</strong><br>Please select at least one answer.";
    return;
  }

  // Disable changes
  for (let inp of inputs) {
    inp.disabled = true;
  }

  let isCorrect = false;
  if (questionData.multipleCorrect) {
    // All-or-nothing
    if (
      selectedValues.length === questionData.correctAnswers.length &&
      selectedValues.every(val => questionData.correctAnswers.includes(val))
    ) {
      isCorrect = true;
    }
  } else {
    if (selectedValues[0] === questionData.correctAnswers[0]) {
      isCorrect = true;
    }
  }

  // Highlight
  questionData.options.forEach((_, i) => {
    const elem = document.getElementById(`option-${currentQuestionIndex}-${i}`);
    if (questionData.correctAnswers.includes(i)) {
      elem.parentElement.classList.add('correct');
    }
    if (!questionData.correctAnswers.includes(i) && selectedValues.includes(i)) {
      elem.parentElement.classList.add('incorrect');
    }
  });

  // Explanation
  if (isCorrect) {
    explanationBox.innerHTML = `<strong style="color:green;">Correct answer!</strong><br>${questionData.explanation}`;
    if (correctCountByTopic[questionData.topic] !== undefined) {
      correctCountByTopic[questionData.topic]++;
    }
  } else {
    explanationBox.innerHTML = `<strong style="color:red;">Wrong answer!</strong><br>${questionData.explanation}`;
  }

  // If first time answering this question, increment answeredCount
  if (userAnswers[currentQuestionIndex] === null) {
    answeredCount++;
  }
  // Save user selection(s)
  userAnswers[currentQuestionIndex] = selectedValues;

  updateAnsweredCounter();

  // If last question, enable final score button
  if (currentQuestionIndex === questions.length - 1) {
    document.getElementById('final-score-btn').disabled = false;
  }
}

function updateAnsweredCounter() {
  document.getElementById('question-counter').innerText = `Answered ${answeredCount} of ${questions.length}`;
}

function goToPrevQuestion() {
  if (currentQuestionIndex > 0) {
    currentQuestionIndex--;
    showQuestion(currentQuestionIndex);
    updateArrows();
  }
}

function goToNextQuestion() {
  if (currentQuestionIndex < questions.length - 1) {
    currentQuestionIndex++;
    showQuestion(currentQuestionIndex);
    updateArrows();
  }
}

function updateArrows() {
  document.getElementById('prev-btn').disabled = currentQuestionIndex === 0;
  document.getElementById('next-btn').disabled = currentQuestionIndex === (questions.length - 1);
}

function showFinalScore() {
  // Hide quiz container & about
  document.getElementById('quiz-container').classList.remove('active');
  document.getElementById('about-container').classList.remove('active');

  // Show final container
  const finalContainer = document.getElementById('final-score-container');
  finalContainer.classList.add('active');

  // Stop the timer
  if (timerInterval) {
    clearInterval(timerInterval);
  }

  let totalCorrect = 0;
  let totalQuestions = questions.length;
  for (let t in correctCountByTopic) {
    totalCorrect += correctCountByTopic[t];
  }

  // Score summary
  const scoreSummary = document.getElementById('score-summary');
  scoreSummary.innerHTML = `You answered <strong>${totalCorrect}</strong> out of <strong>${totalQuestions}</strong> questions correctly.`;

  // 70% threshold
  const passFailEl = document.getElementById('score-passfail');
  let percentage = (totalCorrect / totalQuestions) * 100;
  if (percentage >= 70) {
    passFailEl.style.color = "green";
    passFailEl.innerText = "Congratulations! You have PASSED the exam.";
  } else {
    passFailEl.style.color = "red";
    passFailEl.innerText = "You have NOT passed the exam. Keep studying!";
  }

  // Show topic stats
  const topicStats = document.getElementById('topic-stats');
  topicStats.innerHTML = '';

  let topicIndex = 0;
  for (let topic in questionCountByTopic) {
    topicIndex++;
    const topicDiv = document.createElement('div');
    topicDiv.classList.add('topic-result');
    const heading = document.createElement('h3');
    heading.innerText = topic;
    topicDiv.appendChild(heading);

    const correct = correctCountByTopic[topic];
    const total = questionCountByTopic[topic];
    const textP = document.createElement('p');
    textP.innerHTML = `Correct answers: <strong>${correct}</strong> / ${total}`;
    topicDiv.appendChild(textP);

    const chartCanvas = document.createElement('canvas');
    chartCanvas.id = `chart-topic-${topicIndex}`;
    chartCanvas.width = 300;
    chartCanvas.height = 300;
    topicDiv.appendChild(chartCanvas);

    topicStats.appendChild(topicDiv);

    new Chart(chartCanvas, {
      type: 'pie',
      data: {
        labels: ['Correct', 'Incorrect'],
        datasets: [{
          data: [correct, total - correct],
          backgroundColor: ['#4CAF50', '#F44336']
        }]
      },
      options: {
        responsive: false,
        plugins: {
          legend: {
            position: 'bottom'
          }
        }
      }
    });
  }
}

// About show/hide (optional)
function showAbout() {
  document.getElementById('quiz-container').classList.remove('active');
  document.getElementById('final-score-container').classList.remove('active');
  document.getElementById('about-container').classList.add('active');
}
function showQuiz() {
  document.getElementById('about-container').classList.remove('active');
  document.getElementById('final-score-container').classList.remove('active');
  document.getElementById('quiz-container').classList.add('active');
}
</script>

</body>
</html>
